# LINE Bot with Modern UX

This project is a LINE Bot designed to manage and notify events, with a focus on modern user experience (UX) improvements.

## Features

- **Flex Message Replies**: The bot responds with visually appealing Flex Messages for single or multiple event details (using Carousel for multiple events).
- **Basic Commands**: Supports basic text commands like "สวัสดี" and "ล่าสุด".

## Setup

To set up and run this LINE Bot, follow these steps:

### 1. Clone the repository (if applicable)

```bash
git clone https://github.com/watt29/notibot-1234
cd notibot-1234
```

### 2. Install Dependencies

Make sure you have Python installed. Then, install the required Python packages using pip:

```bash
pip install -r requirements.txt
```

### 3. Environment Variables

Create a `.env` file in the root directory of the project (`D:\MybotLine\`) and add your LINE Channel Access Token and Channel Secret:

```
LINE_CHANNEL_ACCESS_TOKEN=YOUR_CHANNEL_ACCESS_TOKEN
LINE_CHANNEL_SECRET=YOUR_CHANNEL_SECRET
ADMIN_USER_ID=YOUR_ADMIN_USER_ID
```

Replace `YOUR_CHANNEL_ACCESS_TOKEN` and `YOUR_CHANNEL_SECRET` with your actual values from the LINE Developers Console.

### 4. Supabase Integration

This bot integrates with Supabase for data storage. Ensure you have a Supabase project set up with the following tables:

#### `public.events` table

Used to store event details.

```sql
CREATE TABLE public.events (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  event_title text not null,
  event_description text null,
  event_date date null,
  created_by text null,
  constraint events_pkey primary key (id)
) TABLESPACE pg_default;
```

#### `public.subscribers` table

Used to store user IDs of users who have subscribed to notifications.

```sql
CREATE TABLE public.subscribers (
  user_id text not null,
  subscribed_at timestamp with time zone not null default now(),
  constraint subscribers_pkey primary key (user_id)
) TABLESPACE pg_default;
```

Make sure to also add your Supabase URL and Anon Key to your `.env` file:

```
SUPABASE_URL=YOUR_SUPABASE_URL
SUPABASE_KEY=YOUR_SUPABASE_ANON_KEY
```

Replace `YOUR_SUPABASE_URL` and `YOUR_SUPABASE_ANON_KEY` with your actual Supabase project URL and public key.

### 5. Run the Bot

You can run the Flask application using:

```bash
python app.py
```

Alternatively, for production environments, you might use a WSGI server like Gunicorn.

### 5. Webhook Setup

To connect your LINE Bot to this application, you will need to set up a webhook URL. If you are running this locally, you can use a tool like ngrok to expose your local server to the internet:

```bash
ngrok http 5000
```

Then, configure the webhook URL in your LINE Developers Console to the ngrok URL followed by `/callback` (e.g., `https://your-ngrok-url.ngrok.io/callback`).

## Usage

- Type `สวัสดี` to get a greeting.
- Type `ล่าสุด` to see the latest event details (now fetched from Supabase).
- Type `/add <title> | <description> | YYYY-MM-DD` (Admin only) to add a new event.
- Type `/subscribe` to subscribe to event notifications.

## Next Steps (Planned Improvements)

- Implement Quick Reply buttons for better user interaction.
- Add `/today` and `/next` commands to fetch events based on dates.
- Implement a welcome message for new followers.
- Integrate with Supabase for dynamic event data management.
- Refine language for a more polite and friendly tone.
"# notibot-1234" 
